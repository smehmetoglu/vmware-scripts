Function Get-BroadcomProductLifecycle {
    <#
        .NOTES
        ===========================================================================
        Created by:    William Lam
        Organization:  Broadcom
        Blog:          http://www.williamlam.com
        Twitter:       @lamw
        ===========================================================================
        .SYNOPSIS
            Retrieves information from the Broadcom Product Support Lifecycle Portal
        .DESCRIPTION
            This cmdlet retrieves information from the Broadcom Product Support Lifecycle Portal
        .PARAMETER Division
            The Broadcom Software Division to filter the product support lifecycle
        .PARAMETER SecretId
            The Broadcom software Product to filter the product support lifecycle
        .PARAMETER Support
            The default support period to filter product support lifecycle

        .EXAMPLE
            $results = Get-BroadcomProductLifecycle -Division VCF -Product "VMware Cloud Foundation"
            $results | ft

        .EXAMPLE
            $results = Get-BroadcomProductLifecycle -Division VCF -Product "VMware Cloud Foundation" -Support 'EOS in 12 months'
            $results | ft

        .EXAMPLE
            $results = Get-BroadcomProductLifecycle -Division VCF -Product "VMware Cloud Foundation" -Support 'EOL in 6 months'
            $results | ft
    #>
    [CmdletBinding()]
    param(
        [Parameter(Mandatory=$true, Position=0)]
        [ValidateSet("Mainframe", "Enterprise", "Cyber Security", "Payment Security", "Tanzu", "VCF", "ANS")]
        [string]$Division,

        [Parameter(Mandatory=$true, Position=1)]
        [ArgumentCompleter({
            param($commandName, $parameterName, $wordToComplete, $commandAst, $fakeBoundParameters)

            # Master Data Dictionary (Mapping to the Friendly Names)
            $ProductData = @{
                "Mainframe"        = @("90S SERVICES", "Accucheck", "ACF2", "ACF2 - DB2 Option", "ACF2 for zVM", "ACF2 - VSE", "ACF2 - z/OS", "ACM/MLINK", "Activator", "Advanced Authentication Mainframe", "Aion Business Rules Expert", "Alert Central", "Allocate DASD Space and Placement", "APAS Insight Monitor for Adabas", "APCDDS Automated Report Balancing", "APCDOC Automated Job Documentation", "Application Lifecycle Conductor", "ARCserve Backup Client", "ARS Resource Management", "ASM2 Backup and Restore", "ASTEX Performance", "Auditor for z/OS", "AutoAction", "Automate", "Automation Analytics & Intelligence", "Automation Point", "Balancing", "Bind Analyzer for DB2 for z/OS", "Blockmaster", "Brightside", "BrightStor SAN Manager - Base", "Bundl", "CA 1 Flexible Storage", "CA 1 Tape Management - Add-On Options", "CA 1 Tape Management - Copycat Utility", "CA 7 Smart Console", "CA 7 Workload Automation", "Calendar Routines", "CA Productivity Accelerator", "Chorus Infrastructure Discipline", "Chorus Platform", "CHORUS SOFTWARE MANAGER", "CICSORT Z/OS", "CIS", "Cleanup", "CleverPath", "Cleverpath Reporter", "Cloud Storage For System Z", "CMA Connection", "CMDB for z/OS", "COBOLVISION Analyzer", "COBOL/XE", "Common Components and Services for z/OS", "COMMON PRODUCT SERVICES COMPONENT", "COMMON SECURITY SERVICES", "Common Services", "Compile/PRF for CICS", "Compile/PRF for TSO", "Compliance Event Manager", "Compliance Manager for z/OS", "Compress Data Compression for Fujitsu", "Compress Data Compression for MVS", "Compress Data Compression (IMS Tools)", "Connect", "Console Management for OpenVMS", "Converter", "CORPORATE TIE", "Cortana", "CREWS Catalog Recovery", "Cross Enterprise Application Performance Management (APM)", "DADS Plus", "DADS Plus for CICS", "Dart", "Database Analyzer for DB2 for z/OS", "Database Analyzer for IMS for z/OS", "Database Command Center Mnt", "Database Copier for IMS for z/OS", "DATABASE MANAGEMENT SOLUTIONS FOR DB2 FOR Z/OS", "DATABASE MANAGEMENT SOLUTIONS FOR IMS FOR Z/OS", "Database Organizer for IMS for z/OS", "Database Organizer (IMS Tools)", "Datacom", "Datacom/AD", "Datacom/DB", "Datacom/Server", "Data Content Discovery", "Datamacs Test Data Generator", "Date Simulator", "Datesolver/2000", "Deliver VSE", "Detector for DB2 for z/OS", "Development Environment for Mainframe", "DISK BACKUP AND RESTORE", "DISK BACKUP AND RESTORE FOR MSP", "Disk Backup and Restore - MVS", "DISK VOS3", "Dispatch Output Mgmt", "Disspla", "Distribulink", "DRIVER", "DUO", "Dynam for VM", "Dynam for VSE", "Dynamic Capacity Intelligence", "DYNAM VM", "Earl", "EASYPROCLIB", "Easytrieve Plus Report Generator Toolkit", "Easytrieve Report Generator", "Easytrieve Report Generator for Common Services", "Email", "Endevor", "Endevor - Enterprise Workbench", "Endevor for Unix", "Endevor Interface for Db2 for z/OS", "Endevor Interface for Remote Db2 for z/OS", "Endevor Natural Integration", "Enterprise Tester", "EPIC Backup", "EPIC Fastcat VSE", "EPIC for CMS System", "EPIC for z/VSE", "EPIC SUPER SYS", "EPIC TAPE MANAGEMENT", "ESM Corp.Misc Products", "ESP Workload Automation", "ETC", "eTrust ALERT", "eTrust Content Inspection Gateway Option for MSP/ISA EE", "eTrust Director", "eTrust VPN Enterprise Edition", "EUREKA:Reporter", "EUREKA:Strategy", "Explore Performance Management", "Explore Performance Management for z/VSE", "ExpressPrint", "Extend DASD VSAM Compression for z/VSE", "EZTEST", "FAQS - Automated Systems Operation", "FAQS Automated Systems Operation", "Fast Check for DB2 for z/OS", "Fast Index for DB2 for z/OS", "Fast Load for DB2 for z/OS", "Fast Recover for DB2 for z/OS", "Fast Unload for DB2 for z/OS", "FAVER VSAM Data Protection", "FAVER VSAM Data Protection for z/OS", "FileAge", "File Master Plus", "File Master Plus for DB2 for z/OS", "File Master Plus for IMS", "Filesave", "FLEE for VSE", "Forest & Trees", "Gen", "GENERIC UNISERVICE FOR CICS", "GENERIC UNISERVICE II", "Gener/OL", "Gen - Host Encyclopedia", "Gen - Workstation Toolset", "Global Subsystem (GSS)", "GRAPHICAL MANAGEMENT INTERFACE", "GRAPHICS", "HB.js", "High Performance Recovery for IMS for z/OS", "Host EDIT", "HTAC", "HYPER-BUF VSAM Buffer Optimizer", "Hyper-Buf VSAM Buffer Optimizer for z/VSE", "iDash Workload Automation", "iDash Workload Automation for CA 7", "Ideal", "Identity Manager MF", "IDMS", "Impact/2000", "IMS TOOLS - MISC", "Index Expert for DB2 for z/OS", "INFOCAI MAINTENANCE", "Innovation Data Processing (UPSTREAM)", "InterTest - Batch", "InterTest - CICS", "InterTest VSE - CICS", "Inventory Discovery Server", "IPC", "ISS", "JARS", "JARS For IDMS", "JARS Performance Management ESA VSE Option", "JARS Resource Accounting", "JARS Resource Accounting VSE", "JARS SMF Director", "JCLCheck Workload Automation", "JMR", "Job Management for OpenVMS", "Jobtrac", "JOBWATCH", "Joe", "Launch Express", "LDAP SERVER FOR Z/OS", "LDM", "Librarian", "Link", "Log Analyzer for DB2 for z/OS", "Look", "Look CICS", "LPD", "Mainframe Application Tuner", "Mainframe Chorus DBA Discipline", "Mainframe Chorus Security Discipline", "Mainframe Chorus Storage Discipline", "Mainframe Configuration Manager for IMS for z/OS", "MAINFRAME CONNECTOR FOR LINUX ON MAINFRAME", "Mainframe Extended Terminal Manager (IMS Tools)", "MAINFRAME MISCELLANEOUS", "MAINFRAME NETWORK MANAGEMENT", "Mainframe Operational Intelligence", "Mainframe Program Restart Manager for IMS for z/OS", "MAINFRAME SECURITY INSIGHTS PLATFORM", "Mainframe Software Manager (Chorus Software Manager)", "Mainframe VM Product Manager", "MasterCat VSAM Catalog Management", "MasterCat VSE", "Max", "MAZDAMON", "Merge/Modify for DB2 for z/OS", "MetaCOBOL Plus", "Metanet", "MF - MISC OLD CODES", "MF PPM - Project Engineer (AllFusion)", "MICS Resource Management", "Migrate COBOL", "MIM Data Sharing (MII)", "MIM Message Sharing (MIC)", "MIM Resource Sharing (MIM)", "MIM Tape Sharing (MIA)", "Nastel AutoPilot for WebSphere MQ", "NetCompress", "Netman", "NetMaster File Transfer Management", "NetMaster Network Automation", "NetMaster Network Management for SNA", "NetMaster Network Management for TCP/IP", "NetSpy Network Performance", "netViz", "Nine/R+", "NXBRIDGE - SYSVIEW/ENDEVOR", "OLAP", "OM Deliver", "OM Spool", "OM View", "Opera", "Opera VM", "Opera VSE", "OPS/MVS Event Management & Automation", "Optimizer/II", "Output Management Document Viewer", "OUTPUT MANAGEMENT WEB SERVICES", "Output Management Web Viewer", "PAM CLIENT FOR LINUX ON MAINFRAME", "PanApt", "PanAudit", "PanAudit Plus", "PAN/SQL", "Panvalet", "Paramount FOR NAVIGRAPH/HOST", "PDSMAN", "Performance Management for OpenVMS", "Plan Analyzer for DB2 for z/OS", "PLEU", "PMO Runtime Performance Optimizer", "Portal", "Process Automation Manager", "Project Planner", "Quick Copy for DB2 for z/OS", "QuickFetch", "Ramis Reporter", "Rapid Reorg for DB2 for z/OS", "Raps VSE", "RC Compare for DB2 for z/OS", "RC/Extract for DB2 for z/OS", "RC/Migrator for DB2 for z/OS", "RC/Query for DB2 for z/OS", "RC/Secure for DB2 for z/OS", "RC/Update for DB2 for z/OS", "RDX", "Realia", "REALIA- MISC", "Recovery Analyzer for DB2 for z/OS", "Remote Console", "Report Facility", "Report Facility for CICS", "Report Facility for IMS", "Report Facility for TSO", "Repository", "Research Planmacs Unlimited", "RLX", "RLX CLIST", "RLX Compile", "RLX ISPF", "RLX SQL", "RLX TSO", "Roscoe", "RSVP", "Scheduler Job Management", "Scheduler Smart Console", "Scheduler VSE", "ShareOption/5", "Smart Restart", "Smart RRSAF", "SMR", "SOLVE", "SOLVE: Access Session Management", "SOLVE:Central Service Desk", "Solve:CPT", "SOLVE:FTS", "SOLVE LINK", "SOLVE:Operations Automation", "Sort System", "SORT Z/OS", "SpaceMan", "SPOOLMAN", "SQL-Ease for DB2 for z/OS", "SRAM", "SRAM z/OS", "Stabilize", "Storage Command Center", "Storage Resource Mgmt", "Subsystem Analyzer for DB2 for z/OS", "SuperCalc", "SUPERPROJECT MISC", "Support Offerings", "SymDump Batch", "SymDump for CICS", "SYSTEMS MANAGEMENT FOR OPENVMS", "System Watchdog for OpenVMS", "SYSVIEW Performance Management", "SYSVIEW Performance Management Option for DB2 for z/OS", "Tape Encryption", "Tape Management z/OS", "Tape/Manager VSE-ESA OPTION", "TASKLIB", "TCPaccess", "TCPAccess X.25 Server", "Team Build", "Teleview", "Telon Application Generator", "Test4z", "TestCoverage", "Thread Sentry", "Thread Stopper", "TLMS Tape Management", "Topology", "Top Secret", "Top Secret - LDAP", "Top Secret - VSE", "TPX - Session Management", "Training", "TRILOGexpert - TriTune", "Trusted Access Manager for Z", "TSO", "Ucandu", "UFO", "UNICENTER JCLCHECK COMMON COMPONENT", "Unicenter Job Management Option", "Unicenter Network and Systems Management Database Performance Monitor Option", "Unicenter Performance Management", "Unified Infrastructure Management for Mainframe", "Vantage for VM", "Vantage Storage Resource Manager", "Velocity Software Performance Suite", "Verify", "VISION:ASSESS", "Vision:Builder", "VISION:DAGER", "VISION:EIGHTY", "Vision:Excel", "Vision:Forms", "Vision:Inform", "Vision:Inquiry", "Vision:Intraccess", "Vision:Legacy", "Vision:Recode", "Vision:Redocument", "VISION:RENAISSANCE", "Vision:Report", "Vision:Results", "Vision:Sixty", "VISION:SUBROUTINES", "Vision:Transact", "Vision:Transact for IMS", "Vision:Two", "VISION:VAM", "VISUAL EXPRESS", "VM:Account", "Vman Session Management for z/OS", "VM:Archiver for z/VM", "VM:Backup for z/VM", "VM:Backup High-Speed Disaster Recovery Option (HiDRO)", "VM:Batch", "VM:DBA", "VM:DB Admin", "VM:DB Center", "VM:DB Developer", "VM:DB Editor", "VM:DB Monitor", "VM:DB Reorganizer", "VM:DB Reporter", "VM:DB Restore", "VM:DB REXX", "VM:DB SQLMAP", "VM:DB Suite", "VM:Director for z/VM", "VMLIB for z/OS", "VM:Monitor", "VM:Notekeeper", "VM:Operator", "VM:Prorexx", "VM:Schedule", "VM:Secure for z/VM", "VM:Sort", "VM:Spool", "VM:Tape for z/VM", "Vollie", "VSAMAid VSAM Tools for z/VSE", "V/Solver", "Vtape Virtual Tape System", "VTERM", "WatchTower", "WEB ADMINISTRATOR FOR ACF2", "WEB ADMINISTRATOR FOR TOP SECRET", "Workload Automation Agent", "Workload Automation Restart Option for z/OS Schedulers (CA 11)", "XCOM Data Transport", "XCOM Data Transport - z/OS", "XMENU for z/VM", "Xpertware", "Zowe")
                "Enterprise"       = @("Advantage Data Transformer", "Automation Analytics & Intelligence", "Autosys Workload Automation", "CA 2E", "CA Agile Requirements Designer", "CA Agile Vision", "CA App Experience Analytics", "CA Application Delivery Analysis MTP (NetQoS / ADA)", "CA Application Delivery Analysis (NetQoS / ADA)", "CA Application Performance Management Agent (APM / Wily / Introscope)", "CA Application Performance Management (APM / Wily / Introscope)", "CA Application Performance Management SaaS", "CA Application Test", "CA Automation Suite for Clouds", "CA Automation Suite For Data Centers", "CA Automation Suite for Data Centers - Configuration Automation", "CA Automic Applications Manager (AM)", "CA Automic Dollar Universe", "CA Automic One Automation", "CA Automic Operations Manager", "CA Automic Oracle", "CA Automic Service Orchestration - Automation Engine", "CA Automic Sysload", "CA Automic Workload Automation - Automation Engine", "CA Business Service Insight", "CA Capacity Manager", "CA Client Automation - Asset Intelligence", "CA Client Automation - Asset Management", "CA Client Automation - IT Client Manager", "CA Client Automation - Remote Control", "CA Client Automation - Software Delivery", "CA Configuration Automation", "CA Continuous Application Insight (PathFinder)", "CA Continuous Delivery Automation - Automation Engine", "CA Database Analyzer for DB2 for Oracle", "CA Distributed Database Management", "CA ecoMeter", "CA ECOMETER SERVER COMPONENT FOC", "CA eHealth", "CA eHealth Application Response", "CA Executive Insight", "CA Harvest Software Change Manager", "CA Harvest Software Change Manager - OpenMake Meister", "CA Infrastructure Management", "CA IT Asset Manager", "CA IT Asset Manager Asset Portfolio Management", "CA Mediation Manager", "CA Mobile Device Management", "CA NetVoyant (NetQoS / NV)", "CA Performance Management", "CA Plex", "CA Process Automation Base", "CA Process Automation Power Pack for Spectrum, IM, and BMC Remedy", "CA Productivity Accelerator", "CA Release Automation Connector", "CA Release Automation - DataManagement Server (Nolio)", "CA Release Automation - Release Operations Center (Nolio)", "CA Service Catalog", "CA Service Desk Manager", "CA Service Desk Manager - Mobile Application", "CA Service Desk Manager - Unified Self Service", "CA Service Desk Manager - Xtraction", "CA Service Management - Asset Portfolio Management", "CA Service Management - Service Desk Manager", "CA Service Operations Insight (SOI)", "CA Software Asset Manager (CA SAM)", "CA Test Data Manager (Data Finder / Grid Tools)", "CA Unicenter NSM", "CA Unified Communications Monitor (NetQoS / UCM)", "CA Virtual Assurance for IM", "CA Visual Infrastructure", "CA Workload Automation Advanced Integration", "CA Workload Automation Advanced Integration for Hadoop", "CA Workload Automation iXP", "CENDURA", "Clarity PPM On Premise", "CleverPath Portal", "CleverPath Predictive Analysis Server", "ConnectALL", "ConnectAll On-Prem", "Continuous Delivery Director", "Continuous Delivery Director SAAS", "DX Application Performance Management", "DX Operational Intelligence", "DX Operational Observability", "DX SaaS", "DX Unified Infrastructure Management (Nimsoft / UIM)", "ESP dSeries Workload Automation", "ESP dSeries Workload Automation - Business Agents (dSeries)", "Insights On-Prem", "Network Flow Analysis", "Network Observability", "Rally On-Premise", "Service Virtualization", "Spectrum", "SUPPORT AUTOMATION- SERVER", "Support Offerings", "SystemEDGE Agent", "Training", "VIP Authentication Hub", "Virtual Network Assurance", "VMware Smart Assurance", "VMware Telco Cloud Operations", "VMware Telco Cloud Service Assurance", "Workload Automation Agent")
                "Cyber Security"   = @("Advanced Endpoint Defense (with SEP)", "Advanced RP-VA", "Advanced Threat Protection Platform", "AntiSpam", "API SECURITY", "ASG-S200", "ASG-S400", "ASG-S500", "Asset Management Suite", "Blue Coat DLP Subscription", "CA Advanced Authentication - Strong Authentication (AuthMinder / WebFort)", "CA API Developer Portal", "CA API Gateway", "CA API Gateway Enterprise Service Manager (Layer 7)", "CA API Gateway Precision API Monitoring Module for API Gateway (Layer 7)", "CA Audit", "CA Data Protection (DataMinder)", "CA Directory", "CA Enterprise Log Manager", "CA Identity Governance", "CA Identity Manager", "CA Identity Portal", "CA Identity Service", "CA Identity Suite", "CA Live API Creator", "CA Microgateway", "CA Mobile API Gateway", "CA Mobile - APP Services", "CA Policy and Configuration Mgr", "CA Privileged Access Manager - Cloakware Password Authority (PA)", "CA Privileged Access Manager (PAM)", "CA Privileged Access Manager - Server Control (PAMSC)", "CA Privileged Identity Management Endpoint (PIM)", "CA Rapid App Security", "Carbon Black App Control", "Carbon Black Cloud Endpoint Standard", "Carbon Black Cloud Endpoint Standard (formerly Cb Defense)", "Carbon Black Cloud Enterprise EDR", "Carbon Black Cloud Managed Detection and Response", "Carbon Black Cloud Workload", "Carbon Black EDR", "Carbon Black EDR (formerly Cb Response)", "CA Risk Authentication", "CASB Audit SpanVA", "CASB Security Advanced", "CASB Securlet SAAS With DLP-CDS", "CA Secure Cloud SaaS - Advanced Authentication", "CA Secure Cloud SaaS - Single Sign On", "CA Security Command Center", "CA Single Sign-On", "CA Single Sign On Agents (SiteMinder)", "CA Single Sign On Federation (SiteMinder)", "CA Single Sign On Secure Proxy Server (SiteMinder)", "CAS-S200", "CAS-S400", "CAS-S500", "CA Strong Authentication", "CAS-VA", "CA Threat Analytics for PAM", "CA User Activity Reporting", "CA Virtual Privilege Manager", "CF-500", "CF-5000", "Client Management Suite", "Cloud Access Security Broker for IaaS", "Cloud Access Security Broker for SaaS", "Cloud Secure Web Gateway", "Cloud Secure Web Gateway - Cloud SWG", "CloudSOC Data Retention", "Cloud Workload Protection for Storage", "Cloud Workload Protection for Storage DLP", "Complete Endpoint Defense (with SEP)", "Control Compliance Suite", "Control Compliance Suite Assessment Manager", "Control Compliance Suite Databases Oracle", "Control Compliance Suite Data Privacy", "Control Compliance Suite Directory Services", "Control Compliance Suite Policy Manager", "Control Compliance Suite Risk Manager", "Control Compliance Suite Standards Database", "Control Compliance Suite Standards Middleware", "Control Compliance Suite Standards Module", "Control Compliance Suite Standards Network Devices", "Control Compliance Suite Standards Server", "Control Compliance Suite Standards Virtual Server", "Control Compliance Suite Vulnerability Manager", "Critical System Protection", "Data Center Security Monitoring Edition", "Data Center Security Server", "Data Center Security Server Advanced", "Data Insight for DLP", "Data Loss Prevention", "Data Loss Prevention API Detection", "Data Loss Prevention API Detection for Developer Apps Virtual Appliance", "Data Loss Prevention API Detection Virtual Appliance", "Data Loss Prevention Cloud Detection Service", "Data Loss Prevention Cloud Detection Service for API Detection", "Data Loss Prevention Cloud Detection Service for ICAP", "Data Loss Prevention Cloud Detection Service for REST", "Data Loss Prevention Cloud Package", "Data Loss Prevention Cloud Prevent for Microsoft Office 365", "Data Loss Prevention Cloud Service for Discovery/Connector", "Data Loss Prevention Cloud Service for Email", "Data Loss Prevention Cloud Storage", "Data Loss Prevention Core API Detection", "Data Loss Prevention Core Package", "Data Loss Prevention Data Access Governance", "Data Loss Prevention Discover Suite", "Data Loss Prevention Endpoint Discover", "Data Loss Prevention Endpoint Prevent", "Data Loss Prevention Endpoint Suite", "Data Loss Prevention Enforce", "Data Loss Prevention Enterprise Suite", "Data Loss Prevention for Mobile", "Data Loss Prevention Form Recognition", "Data Loss Prevention for Office 365 Email and Gmail with Email Safeguard", "Data Loss Prevention Network Discover", "Data Loss Prevention Network Email", "Data Loss Prevention Network Monitor", "Data Loss Prevention Network Monitor and Prevent for Email", "Data Loss Prevention Network Monitor and Prevent for Email and Web", "Data Loss Prevention Network Monitor and Prevent for Web", "Data Loss Prevention Network Prevent for Email", "Data Loss Prevention Network Prevent for Email Virtual Appliance", "Data Loss Prevention Network Prevent for Web Virtual Appliance", "Data Loss Prevention Network Protect", "Data Loss Prevention Network Web", "Data Loss Prevention Oracle Standard Edition 2", "Data Loss Prevention Plus Suite", "Data Loss Prevention Sensitive Image Recognition", "Data Loss Protection Oracle Standard Edition", "Deployment Solution", "Desktop Email Encryption", "DLP-1700", "DLP-2700", "DLP-700", "DLP-S500", "Drive Encryption", "Email", "Email Security.cloud", "Embedded Security Critical System Protection", "Encryption Management Server", "Endpoint Detection and Response", "Endpoint Detection and Response with Email", "Endpoint Detection and Response with Network Sensor", "Endpoint Encryption", "Endpoint Hardening", "Endpoint Hardening Application Control", "Endpoint Protection", "Endpoint Protection for VDI", "Endpoint Protection with Endpoint Detection and Response", "Endpoint Security", "Endpoint Security Complete", "Endpoint Security for Servers", "Endpoint Threat Defense for Active Directory", "eTrust 20/20", "File Share Encryption", "Gateway Email Encryption", "Generic Non Product", "Ghost Solution Suite", "Industrial Control System Protection", "Information Centric Analytics", "Information Centric Encryption", "Information Centric Security", "Information Centric Tagging", "Insight for Private Clouds Endpoint Edition", "IntelligenceCenter", "Inventory Solution", "ISG Content Analysis", "ISG Proxy", "ISG SSLV", "IT Analytics", "IT Management Suite", "Mail Security for Microsoft Exchange", "Management Center", "Management Center - VA", "Messaging Gateway", "Messaging Gateway for Service Providers", "Mobile Encryption for iOS", "MTD-S400", "PacketShaper", "PacketShaper S-Series", "Patch Management Solution", "Patch Management Solution for Servers", "PGP Command Line", "PGP Encryption Suite", "PGP Key Management Server", "PGP Key Mgmt Client Access and CLI API", "PGP SDK", "PolicyCenter", "PolicyCenter S-Series", "Protection Engine for Cloud Services", "Protection Engine for NAS", "Protection for SharePoint Servers", "Protection Suite Enterprise Edition", "Reporter-S500", "Reporter-VA", "Security Analytics", "Server Management Suite", "SG-300", "SG-510", "SG-600", "SG-900", "SG-9000", "SG-S200", "SG-S200-RP", "SG-S400", "SG-S400-RP", "SG-S500", "SG-S500-RP", "SGVA", "SG-VA", "SITEMINDER", "Software Management Solution", "SSL Visibility Appliance Software", "SSP-S210 PLATFORM", "SSP-S410", "SSP-S410 PLATFORM", "SSP-S620 PLATFORM", "Standard RP-VA", "Support Offerings", "SV-1800", "SV-2800", "SV-3800", "SV-800", "SV-S550", "SWG VA-100", "Threat Hunting Center", "Unicenter Network and Systems Management Wireless Network Mgmt Option", "VIP Authentication Hub", "VIP Service", "VMware Carbon Black", "VMware Carbon Black Cloud Container", "VMware Live Recovery", "Web Isolation", "Web Isolation for Cloud SWG")
                "Payment Security" = @("ARCOT ECOMMERCE", "CA Payment Security")
                "Tanzu"            = @("Advanced Cyber Compliance", "App Suite", "Azure Spring Enterprise", "Concourse for VMware Tanzu", "Generic Non Product", "On Demand Services SDK", "Operations Manager", "Pivotal Web Server", "RabbitMQ", "Redis for VMware Tanzu", "Services Suite", "Support Offerings", "Support Only for Apache HTTP", "Support Only for Apache Tomcat", "Tanzu Kubernetes Runtime", "VCF Automation", "VCF Operations", "VCF Operations/Automation (formerly VMware Aria Suite)", "VCF Operations for Networks", "VMware Chiseled Ubuntu Containers", "VMware Cloud Foundation", "VMware Cloud Foundation Edge", "VMware Cloud Native Runtimes", "VMware Container Networking with Antrea", "VMware SaltStack", "VMware Tanzu Advanced", "VMware Tanzu Application Catalog", "VMware Tanzu Application Platform", "VMware Tanzu Application Service", "VMware Tanzu Build Service", "VMware Tanzu CLI", "VMware Tanzu Data Intelligence", "VMware Tanzu Data Services", "VMware Tanzu Data Services Pack", "VMware Tanzu Data Services Solutions", "VMware Tanzu Data Suite", "VMware Tanzu for Kubernetes Operations", "VMware Tanzu for MySQL", "VMware Tanzu for Postgres", "VMware Tanzu for Valkey", "VMware Tanzu Gemfire", "VMware Tanzu Greenplum", "VMware Tanzu Greenplum Decision Support Benchmark", "VMware Tanzu Guardrails", "VMware Tanzu Insights", "VMware Tanzu Kubernetes Grid Integrated Edition", "VMware Tanzu Kubernetes Grid Management", "VMware Tanzu Kubernetes Grid Plus", "VMware Tanzu Mission Control", "VMware Tanzu Mission Control - SM", "VMware Tanzu Platform", "VMware Tanzu Platform - Cloud Foundry", "VMware Tanzu Platform Core", "VMware Tanzu Platform Data", "VMware Tanzu Platform - Hub", "VMware Tanzu Platform - Kubernetes", "VMware Tanzu Platform - SaaS Components", "Vmware Tanzu Platform - SM", "VMware Tanzu Platform Spring", "VMware Tanzu Platform - TAP", "VMware Tanzu RabbitMQ", "VMware Tanzu Service Mesh", "VMware Tanzu Spring Essentials", "VMware Tanzu Spring Runtime", "VMware Tanzu Spring Runtime - SM", "VMware Tanzu Spring SaaS", "VMware Tanzu SQL", "VMware Tanzu tc Server", "VMware Tanzu Toolkit for Kubernetes", "VMware Telco Cloud Platform", "VMware vFabric", "VMware vSphere ESXi")
                "VCF"              = @("Advanced Cyber Compliance", "Flings", "Holodeck", "Support Offerings", "Uhana by VMware", "VCF Automation", "VCF Operations", "VCF Operations/Automation (formerly VMware Aria Suite)", "VCF Operations for Networks", "VMmark", "VMware", "VMware Aria Automation", "VMware Aria Operations", "VMware Aria Operations for Integrations Management Packs", "VMware Aria Suite", "VMware Bare Metal Automation", "VMware Centralized RAN Intelligence Controller", "VMware Chiseled Ubuntu Containers", "VMware Cloud Director", "VMware Cloud Director App Launchpad", "VMware Cloud Director Availability", "VMware Cloud Director Extension for VMware Data Solutions", "VMware Cloud Director Object Storage Extension", "VMware Cloud Foundation", "VMware Cloud Foundation Edge", "VMware Cloud Gateway for VMC HLM", "VMware Cloud on AWS", "VMware Cloud On-Premise Components", "VMware Cloud Provider Lifecycle Manager", "VMware Container Networking with Antrea", "VMware Data Services Manager", "VMware Data Services Manager for PAIF", "VMware Data Services Manager for VCF", "VMware Desktop Hypervisor", "VMware Distributed RAN Intelligence Controller", "VMware Edge Cloud Orchestrator", "VMware Edge Compute Stack", "VMware Edge Intelligence", "VMware Fusion", "VMware HCX", "VMware Identity Manager", "VMware Integrated OpenStack", "VMware Live Recovery", "VMware NSX", "VMware NSX Data Center for vSphere", "VMware Photon Platform", "VMware Private AI Foundation", "VMware Private Mobile Network", "VMware Salt", "VMware SaltStack", "VMware SDDC Manager", "VMware Site Recovery Manager", "VMware Skyline Collector", "VMware Tanzu Data Services Pack", "VMware Tanzu Data Suite", "VMware Tanzu Guardrails", "VMware Tanzu Kubernetes Grid Integrated Edition", "VMware Tanzu Mission Control", "VMware Tanzu Platform Services - SALT", "VMware Tanzu Service Mesh", "VMware Tanzu SQL", "VMware Telco Cloud Automation", "VMware Telco Cloud Infrastructure", "VMware Telco Cloud Infrastructure - Cloud Director Edition", "VMware Telco Cloud Infrastructure - OpenStack Edition", "VMware Telco Cloud Platform", "VMware Telco Cloud Platform - 5G Edition", "VMware Telco Cloud Service Assurance", "VMware Tools", "VMware Usage Meter", "VMware Validated Design for Software-Defined Data Center", "VMware vCenter converter", "VMware vCenter Server", "VMware vCloud NFV", "VMware vCloud NFV OpenStack Edition", "VMware vCloud Suite", "VMware vCloud Suite Platinum", "VMware vCloud Suite Subscription", "VMware vCloud Usage Meter", "VMware vDefend Firewall", "VMware vDefend Firewall with Advanced Threat Prevention", "VMware vDefend Network Detection and Response", "VMware VeloCloud SD-Access", "VMware VeloCloud SD-WAN", "VMware VeloCloud SD-WAN Edge Appliance", "VMware vRealize Automation", "VMware vRealize Business for Cloud", "VMware vRealize Code Stream", "VMware vRealize Configuration Manager", "VMware vRealize Hyperic", "VMware vRealize Log Insight", "VMware vRealize Network Insight", "VMware vRealize Operations", "VMware vRealize Operations Insight", "VMware vRealize Operations Management Pack for MEDITECH", "VMware vSAN", "VMware vSphere", "VMware vSphere ESX Drivers", "VMware vSphere ESXi", "VMware vSphere Foundation", "VMware vSphere Kubernetes Service", "VMware Workstation", "VMware Workstation Player", "VMware Workstation Pro", "vSphere Kubernetes releases", "vSphere Supervisor Service")
                "ANS"              = @("Tanzu Kubernetes Runtime", "vDefend Security Services Platform", "VMware Avi Load Balancer", "VMware Cloud Foundation", "VMware Cloud Foundation Edge", "VMware Firewall", "VMware NSX", "VMware Tanzu for Kubernetes Operations", "VMware Tanzu Service Mesh", "VMware Telco Cloud Platform", "VMware vDefend Firewall", "VMware vDefend Firewall with Advanced Threat Prevention", "VMware vDefend Network Detection and Response", "VMware vSphere Foundation", "VMware vSphere Kubernetes Service")
            }

            $SelectedDivision = $fakeBoundParameters['Division']
            $Choices = $ProductData[$SelectedDivision]

            $Choices | Where-Object { $_ -like "*$wordToComplete*" } | ForEach-Object {
                [System.Management.Automation.CompletionResult]::new($_, $_, 'ParameterValue', $_)
            }
        })]
        [string]$Product,

        [Parameter(Mandatory = $false, HelpMessage = "Filter results based on support timelines.")]
        [ValidateSet(
            'Supported Products',
            'EOS in 6 months',
            'EOS in 12 months',
            'EOL in 6 months',
            'EOL in 12 months'
        )]
        [string]$Support
    )

    process {
        # Division Key Mapping Table
        $DivisionKeyMap = @{
            "Mainframe"        = "ME"
            "Enterprise"       = "ES"
            "Cyber Security"   = "SE"
            "Payment Security" = "PZ"
            "Tanzu"            = "VT"
            "VCF"              = "VC"
            "ANS"              = "VA"
        }

        $DivisionCode = $DivisionKeyMap[$Division]

        Write-Verbose "Querying lifecycle data for $Product ..."

        $uri = "https://support.broadcom.com/web/ecx/productlifecycle/-/productLifecycle/getproductlifecycledetail"

        $payload = @{
            "dateFilter" = $Support
            "description" = ""
            "dropSupportDate" = ""
            "eolDate" = ""
            "gaDate" = ""
            "genLevel" = ""
            "isEntitled" = "false"
            "os" = ""
            "page" = "0"
            "productLine" = $DivisionKeyMap[$Division]
            "productName" = "$Product"
            "release" = ""
            "size" = "1000"
            "sort" = "productName,asc"
            "stabilizationDate" = ""
        }

        $headers = @{
            "Accept"       = "application/json"
            "Content-Type" = "application/json"
        }

        $body = $payload | ConvertTo-Json
        $response = Invoke-WebRequest -Uri $uri -Method POST -Body $body -Headers $headers

        if ($response.StatusCode -eq 200) {
            $rawList = ($response.Content | ConvertFrom-Json).data.lifecycleList

            $rawList
        }
    }
}